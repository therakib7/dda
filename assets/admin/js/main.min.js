!function(e){"use strict";var a={metaTab:function(){e(".exdda-tab-nav li").on("click","a",(function(a){a.preventDefault();var t=e(this),d=t.parents(".exdda-tab-container"),i=d.children(".exdda-tab-nav"),n=d.children(".exdda-tab-content"),s=t.attr("href");switch(s){case"#sc-review":e("#_exdda_sc_tab").val("review");break;case"#sc-schema":e("#_exdda_sc_tab").val("schema");break;case"#sc-settings":e("#_exdda_sc_tab").val("setting");break;case"#sc-affiliate":e("#_exdda_sc_tab").val("affiliate");break;case"#sc-style":e("#_exdda_sc_tab").val("style");break;case"#sc-preview":e("#_exdda_sc_tab").val("preview")}n.hide(),i.find("li").removeClass("active"),t.parent().addClass("active"),d.find(s).show()})),e(document).on("change","#exdda-support input[type=radio]",(function(){switch(e("#exdda-support input[name='exdda_support']:checked").val()){case"review":case"dda":e("#_exdda_sc_tab").val("review"),e(".exdda-tab-nav").find("li").removeClass("active"),e(".exdda-tab-nav").find("li.review-tab").addClass("active"),e(".exdda-tab-container .exdda-tab-content").hide(),e("#sc-review").show();break;case"schema":e("#_exdda_sc_tab").val("schema"),e(".exdda-tab-nav").find("li").removeClass("active"),e(".exdda-tab-nav").find("li.schema-tab").addClass("active"),e(".exdda-tab-container .exdda-tab-content").hide(),e("#sc-schema").show()}}))},alertBox:function(){e('.exdda-radio-image input[type="radio"]').on("click",(function(){if(!exdda.pro&&"yes"==e(this).data("pro"))return e(".exdda-pro-alert").show(),e(".exdda-pro-alert p span").html(""),!1})),e("#exdda-pagination_type").on("change",(function(a){if(e("#exdda-pagination_type option:selected").text().indexOf("[Pro]")>=0&&!exdda.pro)return e("#exdda-pagination_type").val("number").select2(),e(".exdda-pro-alert").show(),!1})),e("#exdda-rich_snippet_cat_back").on("change",(function(a){if(e("#exdda-rich_snippet_cat_back option:selected").text().indexOf("[Pro]")>=0&&!exdda.pro)return e("#exdda-rich_snippet_cat_back").val("article").select2(),e(".exdda-pro-alert").show(),!1})),e("#exdda_meta").on("click",".pro-field",(function(a){a.preventDefault(),e(".exdda-pro-alert").show()})),e(".exdda-pro-alert-close").on("click",(function(a){a.preventDefault(),e(".exdda-pro-alert").hide()})),e(".exdda-post-type-close").on("click",(function(a){a.preventDefault(),e(".exdda-post-type").hide()}))},libSupport:function(){e(".exdda-select2").length&&e.fn.select2&&e(".exdda-select2").select2({dropdownAutoWidth:!0}),e.fn.wpColorPicker&&e(".rt-color").wpColorPicker()},autoFillSchema:function(){function a(a,t){e.ajax({type:"POST",dataType:"json",url:exdda.ajaxurl,data:{action:"exdda_auto_fill_schema",post_id:t,snippet_cat:a},success:function(t){if(t.success){var d=t.data;switch(d.hasOwnProperty("category")&&(a=d.category),a){case"article":case"news_article":case"blog_posting":for(var i in e("#exdda-rich_snippet_cat").val([a]),e("#exdda-rich_snippet_cat").trigger("change"),d)"image"==i||"publisherImage"==i?e("#exdda_"+a+"_schema_holder #exdda_"+a+"_schema_0__"+i+"_").find(".exdda-preview-imgs").html("<div class='exdda-preview-img'><img src='"+d[i].url+"' /><input type='hidden' name='exdda_"+a+"_schema[0]["+i+"]' value='"+d[i].id+"'><button class='exdda-file-remove' data-id='"+d[i].id+"'>x</button></div>"):"description"===i||"articleBody"===i?e("#exdda_"+a+"_schema_holder").find('textarea[name="exdda_'+a+"_schema[0]["+i+']"]').val(d[i]):e("#exdda_"+a+"_schema_holder").find('input[name="exdda_'+a+"_schema[0]["+i+']"]').val(d[i]);break;case"product":for(var n in d)if("image"==n)e("#exdda_"+a+"_schema_holder #exdda_"+a+"_schema_0__"+n+"_").find(".exdda-preview-imgs").html("<div class='exdda-preview-img'><img src='"+d[n].url+"' /><input type='hidden' name='exdda_"+a+"_schema[0]["+n+"]' value='"+d[n].id+"'><button class='exdda-file-remove' data-id='"+d[n].id+"'>x</button></div>");else if("offers"===n)for(var s in d[n][0])e("#exdda_"+a+"_schema_holder").find('input[name="exdda_'+a+"_schema[0]["+s+']"]').val(d[n][0][s]);else if("aggregateRating"===n)for(var c in d[n])e("#exdda_"+a+"_schema_holder").find('input[name="exdda_'+a+"_schema[0]["+c+']"]').val(d[n][c]);else"description"===n?e("#exdda_"+a+"_schema_holder").find('textarea[name="exdda_'+a+"_schema[0]["+n+']"]').val(d[n]):e("#exdda_"+a+"_schema_holder").find('input[name="exdda_'+a+"_schema[0]["+n+']"]').val(d[n])}}}})}var t=e("#post_ID").val(),d=e("#exdda-rich_snippet_cat").val(),i=window.location.href,n=new URL(i).searchParams.get("action");d&&!d.length&&n&&"edit"==n&&(e("body").hasClass("post-type-post")?a("post",t):(e("body").hasClass("post-type-product")||e("body").hasClass("post-type-download"))&&(e("#exdda-rich_snippet_cat").val(["product"]),e("#exdda-rich_snippet_cat").trigger("change"),a("product",t))),e("#exdda-rich_snippet_cat").on("select2:select",(function(e){a(e.params.data.id,t)}))},conditionalField:function(){function a(){var a=e("#exdda-support-dda").is(":checked");e("#exdda-support-review").is(":checked")||a?(e(".exdda-tab-nav.rt-back li:nth-child(1)").show(),e(".exdda-tab-nav.rt-back li:nth-child(2)").show(),e(".exdda-tab-nav.rt-back li:nth-child(4)").show()):(e(".exdda-tab-nav.rt-back li:nth-child(1)").hide(),e(".exdda-tab-nav.rt-back li:nth-child(2)").hide(),e(".exdda-tab-nav.rt-back li:nth-child(4)").hide()),e("#exdda-support-schema").is(":checked")||a?e(".exdda-tab-nav.rt-back li:nth-child(3)").show():e(".exdda-tab-nav.rt-back li:nth-child(3)").hide();var t=e("#exdda-post-type").val();"page"==t?(e("#exdda_page_id_holder").show(),e("#page_schema_holder").show(),e("#rich_snippet_holder").hide(),e("#rich_snippet_cat_holder").hide()):(e("#exdda_page_id_holder").hide(),e("#page_schema_holder").hide(),e("#rich_snippet_holder").show(),e("#rich_snippet_cat_holder").show()),e("#exdda-auto_rich_snippet").is(":checked")&&"page"!=t?e("#rich_snippet_cat_holder").show():e("#rich_snippet_cat_holder").hide(),"page"==e("#exdda-schema-post-type").val()?e("#exdda_schma_page_id_holder").show():e("#exdda_schma_page_id_holder").hide();var d=e("#exdda-rich_snippet_cat").val();if(e("#exdda-rich_snippet_cat option:selected").text().indexOf("[Pro]")>=0?(exdda.pro||e(".exdda-pro-alert").show(),e(".exdda-schema-field").hide()):(e(".exdda-schema-field").hide(),e("#exdda_"+d+"_schema_holder").show()),e(".exdda-schema-field").hide(),d){1==d.length&&(e("#exdda_"+d[0]+"_schema_holder").find(".exdda-accordion-body:first").show(),e("#exdda_"+d[0]+"_schema_holder").find(".exdda-accordion-label:first .exdda-accordion-arrow i").removeClass("dashicons-arrow-down-alt2").addClass("dashicons-arrow-up-alt2"),e("#exdda_"+d[0]+"_schema_holder").find(".exdda-accordion-label:first").addClass("active"));for(var i=0;i<d.length;i++)e("#exdda_"+d[i]+"_schema_holder").show()}e("#exdda-criteria-multi").is(":checked")?e("#multi_criteria_holder").show():e("#multi_criteria_holder").hide(),e("#enable_pros").is(":checked")?e("#pros_holder").show():e("#pros_holder").hide(),e("#enable_cons").is(":checked")?e("#cons_holder").show():e("#cons_holder").hide(),"custom"==e("#exdda-snippet-custom").val()?e(".exdda-snippet-custom").show():e(".exdda-snippet-custom").hide(),e("#exdda-pros_cons").is(":checked")?e("#pros_cons_limit_holder").show():e("#pros_cons_limit_holder").hide(),e("#exdda-filter").is(":checked")?e("#filter_option_holder").show():e("#filter_option_holder").hide(),e("#exdda-enable_pros").is(":checked")?e("#exdda_pros_holder").show():e("#exdda_pros_holder").hide(),e("#exdda-enable_cons").is(":checked")?e("#exdda_cons_holder").show():e("#exdda_cons_holder").hide(),"Restaurant"==e("#exdda_schema_settings-category").val()?e(".exdda_schema_settings-servesCuisine, .exdda_schema_settings-menu, .exdda_schema_settings-acceptsReservations").show():e(".exdda_schema_settings-servesCuisine, .exdda_schema_settings-menu, .exdda_schema_settings-acceptsReservations").hide()}e(document).on("change","#exdda_meta input[type=checkbox], #exdda_meta input[type=radio], #exdda_meta select",(function(){a()})),e("#exdda-rich_snippet_cat").on("change",(function(e){a()})),a()},ajaxEvent:function(){e("#exdda-post-type, #exdda-schema-post-type").on("select2:select",(function(a){var t=a.params.data.id;"page"!=t&&e.ajax({url:exdda.ajaxurl,data:{action:"exdda_check_post_type",post_type:t},type:"POST",dataType:"json",success:function(a){a.success||(e("#exdda-post-type").val("0").select2(),e(".exdda-post-type").show())}})})),e(".exdda-import-schema").on("click",(function(a){var t=e(this),d=e(this).data("id");e.ajax({url:exdda.ajaxurl,data:{action:"exdda_data_import",data_id:d},type:"POST",dataType:"json",beforeSend:function(){t.next().css("visibility","inherit")},success:function(e){t.next().css("visibility","hidden"),e.success?(console.log(e),t.next().next().addClass("success").html("Data has been imported successfully")):t.next().next().addClass("failed").html("Plugin data is not available or it is not activated")}})}))},metaRepeater:function(){function a(a,t){var d="#exdda-"+a;e(d).length&&e(d).sortable(),e(d+" + a").on("click",(function(i){var n=!1,s=null,c=e(d+" label").length;if(!exdda.pro){switch(a){case"multi-criteria":c>=3&&(n=!0,s=exdda.criteria_alt_txt);break;case"pros":c>=3&&(n=!0,s=exdda.pros_alt_txt);break;case"cons":c>=3&&(n=!0,s=exdda.cons_alt_txt)}if(n)return e(".exdda-pro-alert").show(),s&&e(".exdda-pro-alert p span").html(s+" "),!1}i.preventDefault();var r="";"edit"==e(this).data("type")&&(r="rt_"),!e(this).data("single")||"pros"!=t&&"cons"!=t||(r="exdda_");var o=t+"-"+(e(d+" label").length+1),l="<label for='"+o+"'><input type='text' id='"+o+"' name='"+r+t+"[]' value=''><i class='dashicons dashicons-move'></i> <i class='remove dashicons dashicons-dismiss'></i></label>";e(d).append(l)})),e(document).on("click",d+" .remove",(function(a){a.preventDefault(),e(this).parent().remove()}))}a("multi-criteria","multi_criteria"),a("pros","pros"),a("cons","cons")},metaImage:function(){e(document).on("click",".exdda-upload-box",(function(a){a.preventDefault();var t,d,i=e(this).attr("data-name"),n=e(this).attr("data-field"),s=e(this);void 0===t?((t=wp.media.frames.file_frame=wp.media({frame:"post",state:"insert",multiple:"image"!=n})).on("insert",(function(){if(d=t.state().get("selection").first().toJSON(),!(0>e.trim(d.url.length))){var a=t.state().get("selection").toJSON(),c="",r="image"==n?"":"[]";a.forEach((function(e){c+="<div class='exdda-preview-img'><img src='"+e.url+"' /><input type='hidden' name='"+i+r+"' value='"+e.id+"'><button class='exdda-file-remove' data-id='"+e.id+"'>x</button></div>"})),s.prev().html(c)}})),t.open()):t.open()})),e(document).on("click",".exdda-file-remove",(function(a){a.preventDefault(),confirm(exdda.sure_txt)&&(e(this).parent().parent().children(".exdda-preview-img").length<=1?(e(this).parent().children("img").remove(),e(this).parent().children("input").val(0),e(this).remove()):e(this).parent().remove())}))},metaGroup:function(){function a(){e(".exdda-accordion-label").off().on("click",(function(a){a.preventDefault(),e(this).toggleClass("active"),e(this).hasClass("active")?e(this).find(".exdda-accordion-arrow i").removeClass("dashicons-arrow-down-alt2").addClass("dashicons-arrow-up-alt2"):e(this).find(".exdda-accordion-arrow i").removeClass("dashicons-arrow-up-alt2").addClass("dashicons-arrow-down-alt2");var t=e(this).next();"block"==t.css("display")?t.slideUp():t.slideDown()}))}a(),e(document).on("click",".exdda-group-wrap + a",(function(t){var d=!1,i=null,n=e(this).data("pro"),s=e(this).data("id"),c=e(this).data("name");if(!exdda.pro&&"yes"==n)if("rating_criteria"==s){if(e(this).prev().children().length>2)return e(".exdda-pro-alert").show(),exdda.criteria_rating&&e(".exdda-pro-alert p span").html(exdda.criteria_rating+" "),!1}else if(d=!0,i=exdda.multiple_txt,d)return e(".exdda-pro-alert").show(),i&&e(".exdda-pro-alert p span").html(i+" "),!1;t.preventDefault(),e("#"+s+" input").each((function(){e(this).attr("value",e(this).val())})),e("#"+s+" textarea").each((function(){e(this).html(e(this).val())}));var r=e("#"+s+" > .exdda-accordion-wrap:last-child").clone();e("#"+s).append(r),e("#"+s+" > .exdda-accordion-wrap").each((function(a){var t=e(this).html(),d=c;d=(d=d.replaceAll("[","\\[")).replaceAll("]","\\]");var i,n=new RegExp("".concat(d,"\\[([0-9]+)"),"g").exec(t);null!=n&&n.length>1&&(i=t.replaceAll(c+"["+n[1],c+"["+a));var r=new RegExp("".concat(s,"\\_([0-9]+)"),"g").exec(i);null!=r&&r.length>1&&(i=i.replaceAll(s+"_"+r[1],s+"_"+a),e(this).html(i)),e(this).find("> .exdda-accordion-label span.exdda-accordion-counter").html(a+1)})),a()})),e(document).on("click",".exdda-accordion-remove",(function(a){a.preventDefault();var t=e(this).data("id");e("#"+t).find(".exdda-accordion-wrap").length<2?alert(exdda.at_least_txt):confirm(exdda.sure_txt)&&(e(this).closest(".exdda-accordion-wrap").remove(),e("#"+t).find(".exdda-accordion-wrap").each((function(a){e(this).find(".exdda-accordion-label span.exdda-accordion-counter").html(a+1)})))}))},settingGroup:function(){function a(a,t){e("#"+a+" > .exdda-setting-group-wrap").each((function(a){var d=e(this).html(),i=t;i=(i=i.replaceAll("[","\\[")).replaceAll("]","\\]");var n,s=new RegExp("".concat(i,"\\[([0-9]+)"),"g").exec(d);null!=s&&s.length>1&&(n=d.replaceAll(t+"["+s[1],t+"["+a),e(this).html(n))}))}e(document).on("click",".exdda-group-add a",(function(t){var d=e(this).data("pro"),i=e(this).data("id"),n=e(this).data("name");if(!exdda.pro&&"yes"==d)return e(".exdda-pro-alert").show(),!1;t.preventDefault(),e("#"+i+" input").each((function(){e(this).attr("value",e(this).val())}));var s=e("#"+i+" > .exdda-setting-group-wrap:last-child").clone();e("#"+i).append(s),a(i,n)})),e(document).on("click",".exdda-group-remove",(function(t){t.preventDefault();var d=e(this).data("id"),i=e(this).data("name");e("#"+d+" input").each((function(){e(this).attr("value",e(this).val())})),confirm(exdda.sure_txt)&&(e(this).parent().remove(),a(d,i))}))},settingImage:function(){e(".exdda-setting-image-wrap").on("click",".exdda-add-image",(function(a){a.preventDefault();var t,d,i=e(this).parents(".exdda-setting-image-wrap");void 0===t?((t=wp.media.frames.file_frame=wp.media({frame:"post",state:"insert",multiple:!1})).on("insert",(function(){if(d=t.state().get("selection").first().toJSON(),!(0>e.trim(d.url.length))){var a=void 0===d.sizes.medium?d.url:d.sizes.medium.url;i.find(".exdda-setting-image-id").val(d.id),i.find(".image-preview-wrapper").html('<img src="'+a+'" alt="'+d.title+'" />')}})),t.open()):t.open()})),e(".exdda-setting-image-wrap").on("click",".exdda-remove-image",(function(a){a.preventDefault();var t=e(this).parents(".exdda-setting-image-wrap");confirm(exdda.sure_txt)&&(t.find(".exdda-setting-image-id").val(""),t.find(".image-preview-wrapper img").attr("src",t.find(".image-preview-wrapper").data("placeholder")))}))},initialize:function(){a.metaTab(),a.alertBox(),a.libSupport(),a.conditionalField(),a.autoFillSchema(),a.ajaxEvent(),a.metaRepeater(),a.metaImage(),a.metaGroup(),a.settingGroup(),a.settingImage()}};e((function(){a.initialize()})),e(window).on("load",(function(){}))}(jQuery);